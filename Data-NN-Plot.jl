using LinearAlgebra
using PyPlot
include("nn/mynn.jl")
include("plotdefaults.jl")

PCA_Data_Helmholtz = 
[ 156    16         NaN    0.032267743729887055    0.5007982942898209;
  156    64         NaN    0.006354145223240747    0.35910142242814286;
  156    128         NaN   0.004091377279465882    0.3110620176092445;
  156    256        NaN    0.0023633952689072948   0.27992195570891937;
  156    512        NaN    0.0015557018631972956   0.2507070301196629;
  #  
  312    16          NaN   0.02851977728513595      0.273860904454842;
  312    64          NaN   0.004451787035790968     0.20302636427753415;
  312    128         NaN   0.0024728106076248356    0.18427083793975046;
  312    256         NaN   0.0013561887200766187    0.155339999407995;
  312    512         NaN   0.0009216677074719118    0.14175799363603417;
  #  
  625    16           NaN    0.01735479654579431    0.18391673941463002;
  625    64           NaN    0.003672739846786014   0.13629924463748833;  
  625    128         NaN     0.0017351671613586035  0.10900417698843207;   
  625    256          NaN    0.0009537160483335651  0.09359778716672872;
  625    512         NaN     0.0007144833878313992  0.08395080375581404;  
  #  
  1250    16    NaN   0.012003287427061351    0.09391871969017805;
  1250    64   NaN    0.0027691313950998966   0.08974369863593668;
  1250    128  NaN    0.0014175980942963435   0.0745136357129236;
  1250    256  NaN    0.0009093937215063658   0.06307753125295636;
  1250    512   NaN   0.0009660852054757477   0.05946274255998951; 
  #  
  2500    16   NaN  0.014759171072238007    0.06882442026538264;
  2500    64   NaN  0.002830806054013704    0.056767651102786545;
  2500    128  NaN  0.001613800517601699    0.04982010423355529;
  2500    256  NaN  0.0013709734071609158   0.04498550314131384;
  2500    512   NaN  0.0014014011507300212  0.04330356425939093;  
  #  
  5000    16    NaN   0.01736176197437385     0.058479576358644036;
  5000    64   NaN    0.0032006592753933204   0.03538011579692855;
  5000    128  NaN    0.002048918958871488    0.03380213747244003;
  5000    256  NaN    0.0016615086952105433   0.0337829123485522;
  5000    512  NaN    0.0012087616516309166   0.03328945011101596;  
  #  
  10000    16  NaN   0.015546498724072802    0.054590175287560626;
  10000    64  NaN   0.0036814873455766543   0.02628585665903812;
  10000    128 NaN   0.0021727671893241925   0.02270693348164602;
  10000    256 NaN   0.0013476702312730392   0.024035110037250264;
  10000    512 NaN   0.0009288358813897781   0.025509169509566134;
  #  
  20000    16   NaN 0.014009909556163252    0.05185845934557424;
  20000    64  NaN  0.005036539922089507    0.02430133484916205;
  20000    128 NaN 0.0024478788508812696    0.021280512949173273;
  20000    256 NaN 0.0011644308861986463    0.02168139575412656;
  20000    512 NaN  0.0008323537354247879   0.021958703791031327
]

DeepONet_Data_Helmholtz = 
 #################################  
 [ 156    16         NaN     0.04792660424935884     0.47541716934985717;
  156    64         NaN      0.009841323181509067    0.4167513778516056;
  156    128         NaN     0.005456871150169087    0.4296086427925428;
  156    256        NaN       0.0028961886519926613  0.38519306575751916;
  156    512        NaN       0.0024502575508603733  0.4056213926400919;
  # 
  312    16         NaN     0.04792660424935884     0.48314408749043264;
  312    64         NaN      0.009841323181509067    0.3533587671746104;
  312    128         NaN     0.005456871150169087    0.3594690754479747;
  312    256        NaN       0.0028961886519926613  0.3173899191587519;
  312    512        NaN       0.0024502575508603733  0.33744121300799734;
  #  
  #  
  625    16           NaN   0.01933513785832105     0.46180417737571516;
  625    64           NaN   0.004551824224823052    0.3097638061930632;   
  625    128         NaN    0.002422441803964536    0.2840206588874471;   
  625    256          NaN   0.0015418374449303054   0.28210667581498283;
  625    512         NaN    0.001193587913190778    0.2698821562024787;  
  #  
  1250    16   NaN    0.016075554507949494    0.46493348990784805;
  1250    64   NaN    0.0038518661575093916   0.2854612054008432;
  1250    128  NaN    0.0020171094715565985   0.22269598693738535;
  1250    256  NaN    0.0014011077238741177   0.20331844136662375;
  1250    512   NaN   0.0012402545045734786   0.18671867431769476;  
  #  
  2500    16   NaN        0.016369408641842255    0.4661885415738167;
  2500    64   NaN        0.003270696863155166    0.2522520568525474;
  2500    128  NaN        0.002011565070224387    0.18316958643138703;
  2500    256  NaN        0.0015533551228970716   0.17547286554615343;
  2500    512   NaN       0.0014349536367269547   0.15540660637168516;  
  #  
  5000    16    NaN  0.01791614891840884    0.46342068192518526;
  5000    64   NaN   0.0034485396028856685  0.17941539221363215;
  5000    128  NaN   0.0020555829913873488  0.17460166554118958;
  5000    256  NaN   0.0015316220075418507  0.14981931294043124;
  5000    512  NaN   0.0013947171019329633  0.15024389622113962;  
  #  
  10000    16  NaN  0.017195191074751592    0.462664085695401;
  10000    64  NaN  0.0041874831903679485   0.16427412723819834;
  10000    128 NaN  0.0020524571462924787   0.15425525411299607;
  10000    256 NaN  0.0013822306700824686   0.12622178420420432;
  10000    512 NaN  0.0010940795679694906   0.08746846598757073;
  #  
  20000    16   NaN  0.015558461934753381    0.46395605592177863;
  20000    64  NaN   0.004780514236593877    0.15109945741687988;
  20000    128 NaN   0.0023932891804109473   0.1106621605432007;
  20000    256 NaN   0.0014939593680884525   0.08939091588388164;
  20000    512 NaN   0.0010001303521358286   0.05882818892277169
]



PARA_Data_Helmholtz = 
 [ 156    16         NaN     0.04792660424935884     1.47183176192018;
  156    64         NaN      0.009841323181509067    1.9307405343174797;
  156    128         NaN     0.005456871150169087    1.8535062023392141;
  156    256        NaN       0.0028961886519926613  2.6145162190622786;
  156    512        NaN       0.0024502575508603733  2.0554503202498724;
  #  
  312    16          NaN     0.03601850543865765     0.5863699432265533;
  312    64          NaN     0.006507130530178613    0.5529809403308175;
  312    128         NaN      0.003421115650458072   0.7958855690157927;
  312    256         NaN      0.002173315657004154   0.699106053083085;
  312    512         NaN      0.00187543775647452    0.6183862025222118;
  #  
  625    16           NaN   0.01933513785832105     0.6515685315380557;
  625    64           NaN   0.004551824224823052    0.23425402926925876;   
  625    128         NaN    0.002422441803964536    0.24740592155101485;   
  625    256          NaN   0.0015418374449303054   0.32231456032835626;
  625    512         NaN    0.001193587913190778    0.2406247990078411;  
  #  
  1250    16   NaN    0.016075554507949494    0.5220406685522744;
  1250    64   NaN    0.0038518661575093916   0.23633505515503284;
  1250    128  NaN    0.0020171094715565985   0.1902694393267026;
  1250    256  NaN    0.0014011077238741177   0.17047908967137265;
  1250    512   NaN   0.0012402545045734786   0.13536599731104815;  
  #  
  2500    16   NaN        0.016369408641842255    0.6163234339399811;
  2500    64   NaN        0.003270696863155166    0.24752377352819085;
  2500    128  NaN        0.002011565070224387    0.19363025115228152;
  2500    256  NaN        0.0015533551228970716   0.1575513064033845;
  2500    512   NaN       0.0014349536367269547   0.1576683676565604;  
  #  
  5000    16    NaN  0.01791614891840884    0.5048819360949051;
  5000    64   NaN   0.0034485396028856685  0.20746721101675888;
  5000    128  NaN   0.0020555829913873488  0.15667619438842628;
  5000    256  NaN   0.0015316220075418507  0.1389181887152601;
  5000    512  NaN   0.0013947171019329633  0.1254281162561009;  
  #  
  10000    16  NaN  0.017195191074751592    0.4955475432298426;
  10000    64  NaN  0.0041874831903679485   0.2439626767301628;
  10000    128 NaN  0.0020524571462924787   0.17687942673225954;
  10000    256 NaN  0.0013822306700824686   0.16598296839316973;
  10000    512 NaN  0.0010940795679694906   0.17322422615312505;
  # cannot afford 20000
  10000    16  NaN  0.017195191074751592    0.4955475432298426;
  10000    64  NaN  0.0041874831903679485   0.2439626767301628;
  10000    128 NaN  0.0020524571462924787   0.17687942673225954;
  10000    256 NaN  0.0013822306700824686   0.16598296839316973;
  10000    512 NaN  0.0010940795679694906   0.17322422615312505;
]

FNO_Data_Helmholtz =
 [ 156    2         NaN        0.2210014521693572    0.21744706414830992;
  156    4         NaN         0.09932527418893117   0.13258327094790262;
  156    8         NaN         0.05872578216859928    0.1215123542321798;
  156    16        NaN         0.017675954311226424   0.10797258901099364;
  156    32        NaN         0.0049165971830893215  0.11111356707242055;
  #  
  312    2          NaN        0.19068203238436046    0.1653741655919032;
  312    4          NaN        0.07601359707470505    0.11111171000326674;
  312    8         NaN         0.04309874547358889    0.09354332957464533;
  312    16         NaN        0.013748772325925529   0.07934762893292384;
  312    32         NaN        0.00357708932670693    0.08447607172032197;
  #  
  625    2           NaN          0.13797209955453874    0.1356393647313118;
  625    4           NaN          0.052852927967906      0.08777335708141328;   
  625    8         NaN            0.0031742428321391344  0.07376944736242294;   
  625    16          NaN          0.010527498410642147   0.055103608968853954;
  625    32         NaN           0.0031742428321391344  0.0580096803933382;  
  #  
  1250    2    NaN 0.12179827310442924    0.1194745639115572;
  1250     4   NaN 0.04529312025755644    0.07331099607795477;
  1250     8  NaN 0.020865313566476106    0.05822057963460684;
  1250    16  NaN 0.007249637369811535    0.03696945503801107;
  1250    32   NaN  0.002757601120043546  0.03593784035891295;  
  #  
  2500    2   NaN 0.09664646586477757    0.10785287502110004;
  2500     4   NaN 0.03228148005604744   0.06387743534222246;
  2500     8  NaN 0.015420772982388736   0.04854992499575019;
  2500    16  NaN 0.0060910088106058535   0.02709122027121484;
  2500    32   NaN  0.0025998110157437622    0.022522997692227365;  
  #  
  5000    2    NaN           0.0727172123402357    0.0995295665577054;
  5000    4   NaN             0.02807683839481324  0.05583740776628256;
  5000     8  NaN           0.011528103581815958    0.038119009354524315;
  5000    16  NaN          0.004070917027094402    0.020224476451426745;
  5000    32  NaN       0.0023880264116218314     0.014001467860210687;  
  #  
  10000    2  NaN        0.06032699879035354       0.08967334906756878;
  10000    4  NaN          0.019344794865325095    0.049418527940288184;
  10000    8 NaN       0.0087024106613826           0.030670925933029503;
  10000    16 NaN        0.003177880827698391       0.015698506979318336;
  10000    32 NaN         0.0017852196126536002     0.009986109851836227;
  #  
  20000    2   NaN    0.050698157728835944               0.08393159152008593;
  20000    4   NaN        0.017173789267451504           0.04460327097615227;
  20000    8   NaN          0.006442254879069515         0.02535060799396597;
  20000    16  NaN              0.0024305332725256448    0.013687166500650346;
  20000    32  NaN        0.001703380346353515           0.007918243799486663
]
######################################################
#NS
######################################################
PCA_Data_NS = 
[ 156    16         NaN    0.4605269440790674   1.2186841774199568;
  156    64         NaN    0.12295705740592087   0.8310629670468895;
  156    128         NaN   0.053029945474354405   0.6645750325474368;
  156    256        NaN    0.024155865746088735   0.5354438089860011;
  156    512        NaN    0.007685656782677317   0.49707179832029413;
  #  
  312    16          NaN   0.4061468138812397   0.46896098348017734;
  312    64          NaN   0.11849051304339152   0.5336079010235679;
  312    128         NaN   0.04880362119750032   0.44335853513590945;
  312    256         NaN   0.0175888082263867   0.35221964021087676;
  312    512         NaN   0.0065256781489666914   0.3118061568071539;
  #  
  625    16           NaN    0.363093692415487   0.3773597898456187;
  625    64           NaN    0.10687483216882657   0.2226816340754798;  
  625    128         NaN     0.05057964963015008   0.3275554870351507;   
  625    256          NaN    0.01581713332476597   0.2719887937186588;
  625    512         NaN     0.006539251746777073   0.22988584363873793;  
  #  
  1250    16    NaN   0.34239901203976525   0.35394876213335447;
  1250    64   NaN    0.09659145914305145   0.12568044962620772;
  1250    128  NaN    0.05891511877191601   0.16230037447526588;
  1250    256  NaN    0.020469093310919236   0.2059543400959292;
  1250    512   NaN   0.007707235087991482   0.18018489432201865; 
  #  
  2500    16   NaN  0.3439587012689532   0.349524148546195;
  2500    64   NaN  0.08516474312213532   0.09942572347111878;
  2500    128  NaN  0.05081069150591965   0.06952146581640119;
  2500    256  NaN  0.029418206369017742   0.12722447300083467;
  2500    512   NaN  0.012571926083063841   0.15107817267176432;  
  #  todo
  5000    16    NaN   0.344605033726457   0.3514301322913124;
  5000    64   NaN    0.0806649869215545   0.08787424285017831;
  5000    128  NaN    0.04563902266467284   0.05441332747279016;
  5000    256  NaN    0.022890382255635264   0.0399625735269843;
  5000    512  NaN    0.020807149058156456   0.09732157680134786;  
  #  
  10000    16  NaN   0.34710749574442873   0.3511476522044054;
  10000    64  NaN   0.07669613822195874   0.07983375349818746;
  10000    128 NaN   0.045445755624857066   0.050102329075302314;
  10000    256 NaN   0.02763190948655302   0.034348684443923375;
  10000    512 NaN   0.024056045138034488   0.028777487401718076;
  #  ?????
  20000    16 NaN  0.34813341022140537   0.34936359398047145;
  20000    64 NaN  0.0720341307586599   0.07377127531598891;
  20000    128 NaN 0.041655531357016676   0.04403831596905797;
  20000    256 NaN 0.030945830370406907   0.033546081579739;
  20000    512 NaN 0.024654289891594947   0.02654266348914689
]

DeepONet_Data_NS = 
 #################################  
 [ 156    16         NaN    0.6823236037995135   1.0965994258088223;
  156    64         NaN     0.22332388843052683   0.8685441901822833;
  156    128         NaN    0.13788389818369423   0.7217327642810997;
  156    256        NaN     0.0926387926888328   0.6270829225776512;
  156    512        NaN     0.11959660024045686   0.6124303985625325;
  #  
  312    16          NaN    0.5920918415620254   0.7132703193464228;
  312    64          NaN    0.20438609611081196   0.5916774049906257;
  312    128         NaN    0.10547281394364656   0.4873756682449709;
  312    256         NaN    0.06358655652570984   0.39945583181483313;
  312    512         NaN    0.08633713718451563   0.3363341079048183;
  #  
  625    16           NaN    0.505488787180168   0.5125248732928046;
  625    64           NaN    0.18731977969516037   0.321295130258568;  
  625    128         NaN     0.08938945211160969   0.36520905045410174;   
  625    256          NaN    0.049705610314521066   0.29954551132510143;
  625    512         NaN     0.04729276596314312   0.24727751635001988;  
  #  
  1250    16    NaN   0.48375488633763053   0.48802059716270585;
  1250    64   NaN    0.1463045225320293   0.16121094726135068;
  1250    128  NaN    0.09054544032860942   0.18562608901755462;
  1250    256  NaN    0.05281790836345452   0.21806865859666133;
  1250    512   NaN   0.04544998746006488   0.17450553353410342; 
  #  
  2500    16   NaN  0.4449047468628387   0.4483444513676299;
  2500    64   NaN  0.11664017523614394   0.12329129833723948;
  2500    128  NaN  0.0651567139043255   0.0783663627736766;
  2500    256  NaN  0.04941679620912793   0.10260458796460414;
  2500    512   NaN  0.046842023801196356   0.11638213968757355;  
  #  
  5000    16    NaN   0.44060786051061207   0.4468531587113586;
  5000    64   NaN    0.10384854525693495   0.10765609765628274;
  5000    128  NaN    0.05923312147415374   0.06496502959565158;
  5000    256  NaN    0.03945328447453681   0.04864137469300518;
  5000    512  NaN    0.0679997757933887   0.07808885045365166;  
  #  
  10000    16  NaN   0.4408954004181099   0.4437397361818173;
  10000    64  NaN   0.09654046071748165   0.0982182973525812;
  10000    128 NaN   0.05224020509405385   0.05517650146380279;
  10000    256 NaN   0.03677390596071996   0.04110120931348545;
  10000    512 NaN   0.05021867729921666   0.05299066989203525;
  #  ?????
  20000    16   NaN  0.41246251132533335   0.4121163467766536;
  20000    64  NaN   0.0870199999205234   0.08764693351758904;
  20000    128 NaN   0.05090797087191457   0.05247415834110915;
  20000    256 NaN   0.034273759354919914   0.03629471638135709;
  20000    512 NaN   0.04030919341495455   0.04193620966281372
]



PARA_Data_NS = 
 [ 156    16         NaN        0.4817009113503805   4.26485847731814;
  156    64         NaN         0.15920813520008936   8.016100511498273;
  156    128         NaN        0.09173316487379266   5.252461691140093;
  156    256        NaN         0.06186147816100523   2.475510719407746;
  156    512        NaN         0.07237383394187444   1.3392683749715506;
  #  
  312    16          NaN        0.579911428751994   1.7362415424110673;
  312    64          NaN        0.219174605677275   5.573088372403878;
  312    128         NaN        0.17098124221618433   3.9123777827317143;
  312    256         NaN        0.07398615947722617   1.8569723013434924;
  312    512         NaN        0.04189733170414732   0.9556458355900904;
  #  
  625    16           NaN       0.4718089797165145   0.49220149695729426;
  625    64           NaN       0.2903884192431171   2.039897951762062;   
  625    128         NaN        0.15344959861995244   2.258432924131567;   
  625    256          NaN       0.06890992408766512   1.2584854263994432;
  625    512         NaN        0.05196309891415873   0.7242116360031626;  
  #  
  1250    16    NaN  0.4746595258273534   0.485363079664304;
  1250    64   NaN   0.16129120267962568   0.1732828559992677;
  1250    128  NaN   0.13037294748959447   0.16637627915802317;
  1250    256  NaN   0.06533727337450614   0.6081945478692418;
  1250    512   NaN  0.03588343142822981   0.4439861268633558;  
  #  
  2500    16   NaN    0.4670612495076526   0.47109843025515186;
  2500    64   NaN    0.1520547705357872   0.15752028896254378;
  2500    128  NaN    0.08855955326435906   0.09651611101764256;
  2500    256  NaN    0.06290938134926248   0.09567441332150982;
  2500    512   NaN   0.060472142605845   0.2532183624901977;  
  #  
  5000    16    NaN  0.4655672815069447   0.47135633674639776;
  5000    64   NaN   0.15383802424202714   0.15735269684234243;
  5000    128  NaN   0.07426424418497594   0.07884265809298366;
  5000    256  NaN   0.04674108623915223   0.05425594791646079;
  5000    512  NaN   0.04379936653832022   0.05300132757279298;  
  #  
  10000    16  NaN   0.45759987791767087   0.46019298000329584;
  10000    64  NaN   0.13678016887620187   0.13804982738975685;
  10000    128 NaN   0.07564328630871214   0.07750627701519851;
  10000    256 NaN   0.04446516979231643   0.047193449539462674;
  10000    512 NaN   0.03741249818351838   0.0408874673219641;
  # cannot afford 20000
  10000    16  NaN   0.45759987791767087   0.46019298000329584;
  10000    64  NaN   0.13678016887620187   0.13804982738975685;
  10000    128 NaN   0.07564328630871214   0.07750627701519851;
  10000    256 NaN   0.04446516979231643   0.047193449539462674;
  10000    512 NaN   0.03741249818351838   0.0408874673219641;  
]

FNO_Data_NS =
 [ 156    2         NaN        0.11521164270547721   0.12339600022786702;
  156    4         NaN         0.04327309332214869   0.06048789185782274;
  156    8         NaN         0.016168724602231614   0.032072231555596374;
  156    16        NaN         0.005249500053767593   0.023700009744900923;
  156    32        NaN         0.0014658996675653048   0.022899862354955614;
  #  
  312    2          NaN        0.08447800151621684   0.0964155392960096;
  312    4          NaN        0.029398753027168986   0.04714755162310142;
  312    8         NaN         0.012217864979249544   0.022649662748265725;
  312    16         NaN        0.005431252079478537   0.01406571715294073;
  312    32         NaN        0.0017822225416192594   0.012217269443238202;
  #  
  625    2           NaN       0.07806984456181526   0.0705215987443924;
  625    4           NaN       0.02227312042117119   0.03201523081958294;   
  625    8         NaN         0.01030871114730835   0.016649957977235317;   
  625    16          NaN       0.00446023159623146   0.008699347781389952;
  625    32         NaN        0.0022813551280647516   0.005884916285052896;  
  #  
  1250    2    NaN 0.06780118720531464   0.06278538788259029;
  1250     4   NaN 0.017018680108338593   0.024876480447500945;
  1250     8  NaN  0.0079419405143708     0.012542640312761068;
  1250    16  NaN  0.0035085849748924375   0.00562010498624295;
  1250    32   NaN  0.0017741449317894877   0.003267710011359304;  
  #  
  2500    2   NaN  0.057117848440259696   0.057897662657499314;
  2500     4   NaN 0.014145546003431082   0.021100723274052144;
  2500     8  NaN  0.005937939846143127   0.010031615598127246;
  2500    16  NaN  0.002793993064202368   0.004056595138087869;
  2500    32   NaN 0.0014087061800761148   0.0022156884246040134;  
  #  
  5000    2    NaN     0.053494763150066134   0.0529024346254766;
  5000    4   NaN      0.012669489195756615   0.017591067614220083;
  5000     8  NaN      0.00488006997150369   0.008129337667301298;
  5000    16  NaN      0.002081191560672596   0.002879628290119581;
  5000    32  NaN      0.001144796449947171   0.0015851109898416325;  
  #  
  10000    2  NaN      0.046579971103183924   0.04458688607420772;
  10000    4  NaN      0.01040249362718314    0.01529550627656281;
  10000    8 NaN       0.003864795654895715   0.006228204161534086;
  10000    16 NaN      0.0015681422499590554   0.0022393917117733506;
  10000    32 NaN      0.0008914144008886069   0.0012182812025421299;
  #  
  20000    2   NaN    0.04892155617615208   0.0391818240063265;
  20000    4   NaN    0.008901817452069373   0.013341024344973267;
  20000    8   NaN    0.003021176399633987   0.005439075825724285;
  20000    16  NaN    0.001268567710276693   0.001994823907973478;
  20000    32  NaN    0.0008335973911860492   0.0009495193176931935
]
######################################################
# Solid
###############

PCA_Data_Solid = 
[ 156    16         NaN    0.11357795490419946   0.17300330266093625;
  156    64         NaN    0.04785650604632496   0.1555171438097476;
  156    128         NaN   0.027536000950855122   0.1579223654996282;
  156    256        NaN    0.015768088568243764   0.14859757432301784;
  156    512        NaN    0.008026710380706303   0.1458746046893197;
  #  
  312    16          NaN   0.11162090081002625   0.1332856119927404;
  312    64          NaN   0.04188688194109087   0.1259850142107492;
  312    128         NaN   0.02505676992697201   0.11702500944052442;
  312    256         NaN   0.012966973813441043   0.11168882987152419;
  312    512         NaN   0.006281242717713232   0.11088791873659272;
  #  
  625    16           NaN    0.08694705305316157   0.09876099162882608;
  625    64           NaN    0.041527379397561216   0.09367221797535263;  
  625    128         NaN     0.021951621638207505   0.09447500807075779;   
  625    256          NaN    0.011416432893756585   0.0903977865257086;
  625    512         NaN     0.005548063354824352   0.08796312961820399;  
  #  
  1250    16    NaN   0.08323959655787871   0.08807251119211822;
  1250    64   NaN    0.0423289096188587   0.07397797829919026;
  1250    128  NaN    0.02375796420488976   0.07633164395408479;
  1250    256  NaN    0.01050288738441434   0.07367534794701522;
  1250    512   NaN   0.005363692473632316   0.0709425149109577; 
  #  
  2500    16   NaN  0.07978360996581975   0.08121453080022611;
  2500    64   NaN  0.04431792431430159   0.05986327061637096;
  2500    128  NaN  0.0258367759724788   0.06715272160319648;
  2500    256  NaN  0.012044078904295343   0.0678187783988049;
  2500    512   NaN  0.006234549017533784   0.06433617711973359;  
  #  
  5000    16    NaN   0.07247650591487838   0.07333547620274454;
  5000    64   NaN    0.04496860444322229   0.05373009715231799;
  5000    128  NaN    0.029848955279902886   0.061380616373617115;
  5000    256  NaN    0.014633140447374331   0.06562974057643944;
  5000    512  NaN    0.009176110183490354   0.06345607667213714;  
  #  
  10000    16  NaN   0.07061621703634144   0.07085489891527146;
  10000    64  NaN   0.04644917374013051   0.04975507772933423;
  10000    128 NaN   0.03410576725858564   0.05636758222656388;
  10000    256 NaN   0.020109419310930302   0.06465998120322289;
  10000    512 NaN   0.012510275552019681   0.06519014232966086;
  #  
  20000    16   NaN 0.06968902028945718   0.07010400380030836;
  20000    64  NaN  0.04517700137929292   0.046707209402072826;
  20000    128 NaN  0.03722111748615488   0.051998938594154616;
  20000    256 NaN  0.025428953740643957   0.0624401348933131;
  20000    512 NaN  0.01677502076551009   0.06612517934417321
]

DeepONet_Data_Solid = 
 #################################  
 [ 156    16         NaN     0.14262153473786143   0.20911700972455477;
  156    64         NaN      0.0825461629468253   0.19916936629656584;
  156    128         NaN     0.0641641532454597   0.16563255786773382;
  156    256        NaN      0.044255925081537216   0.15127393976307635;
  156    512        NaN      0.03811256536137279   0.14573781939613803;
  #  
  312    16          NaN     0.14343064570456243   0.16446094056008415;
  312    64          NaN     0.07178047815061973   0.14051986776538725;
  312    128         NaN     0.0501239646953582   0.12588693831756098;
  312    256         NaN     0.03367887659480562   0.12146449232378018;
  312    512         NaN     0.033550645716084626   0.11555347780650226;
  #  
  625    16           NaN   0.1333004665686784   0.14259541545274743;
  625    64           NaN   0.06316670217364806   0.1111525155887363;   
  625    128         NaN    0.04136898984351309   0.10405714732813212;   
  625    256          NaN   0.024995251338080646   0.10021888340633221;
  625    512         NaN    0.02456987712904521   0.09220676893161515;  
  #  
  1250    16   NaN    0.11216805347881273   0.11420346606112022;
  1250    64   NaN    0.05779067057862701   0.08695544034015643;
  1250    128  NaN    0.03455626561063574   0.08472193283425433;
  1250    256  NaN    0.020715468874403977   0.07933179702239943;
  1250    512   NaN   0.017953511095994305   0.07584540043217332;  
  #  
  2500    16   NaN       0.10080369414676142   0.10171799749855132;
  2500    64   NaN       0.054940701752072246   0.07135116663367723;
  2500    128  NaN       0.03201521595577919   0.07287209885152629;
  2500    256  NaN       0.018432590252114155   0.07110235271260323;
  2500    512   NaN      0.015496711897852357   0.06732758228280428;  
  #  
  5000    16    NaN  0.10067461807061681   0.10119316827304131;
  5000    64   NaN   0.052689070700674814   0.06161910728686778;
  5000    128  NaN   0.034052042605518966   0.06608319049336267;
  5000    256  NaN   0.021703010813491578   0.06740272601048589;
  5000    512  NaN   0.017313206604374368   0.06580866265873055;  
  #  
  10000    16  NaN  0.09629186957432598   0.09650476270208726;
  10000    64  NaN  0.051094177404038627   0.05535873675459766;
  10000    128 NaN  0.03697136997184957   0.0595448008144785;
  10000    256 NaN  0.02800886536647485   0.06303770903394633;
  10000    512 NaN  0.020595466556320857   0.06386476327391244;
  #  
  20000    16   NaN  0.08214447922175039   0.0824746149540089;
  20000    64  NaN   0.05029818244161458   0.052014380370673234;
  20000    128 NaN   0.04050047397807624   0.052232461655715316;
  20000    256 NaN   0.03114209951595663   0.05872446339965451;
  20000    512 NaN   0.02250886706988622   0.06377522281721379
]



PARA_Data_Solid = 
 [ 156    16         NaN        0.12126418187078628   0.155901216751596;
  156    64         NaN         0.08245048846883009   0.41591145950502917;
  156    128         NaN        0.061419083109788955   0.357271144783621;
  156    256        NaN         0.04460611304643863   0.24642358596844752;
  156    512        NaN         0.020462592671517718   0.2068158117051065;
  #  
  312    16          NaN        0.10902622193760088   0.11630362419063865;
  312    64          NaN        0.06890630506550056   0.14513550583748028;
  312    128         NaN        0.040747435441389986   0.15815065218910362;
  312    256         NaN        0.02887442987046901   0.14906296011183218;
  312    512         NaN        0.019619023615749357   0.13566762377560024;
  #  
  625    16           NaN       0.10877152930806612   0.11374351053573027;
  625    64           NaN       0.05386946046334069   0.07640636277074815;   
  625    128         NaN        0.03547439489346798   0.086732827963942;   
  625    256          NaN       0.019939377996368832   0.08422451133747831;
  625    512         NaN        0.013935312875606178   0.0786522827568006;  
  #  
  1250    16    NaN  0.1059231602704915   0.10758581411965022;
  1250    64   NaN   0.05595115201061856   0.06360704853494817;
  1250    128  NaN   0.034699818675691885   0.07040471408194512;
  1250    256  NaN   0.020329952513192077   0.06977129066766359;
  1250    512   NaN  0.012941735384026452   0.06481673088508715;  
  #  
  2500    16   NaN    0.10952269543325531   0.11075322470323072;
  2500    64   NaN    0.05273241326160547   0.05503011314962456;
  2500    128  NaN    0.037449122417834255   0.06231787379763691;
  2500    256  NaN    0.02279858533363507   0.0659675066794221;
  2500    512   NaN   0.014909880984090535   0.06216764057583373;  
  #  
  5000    16    NaN  0.10158911921752072   0.10191300548088568;
  5000    64   NaN   0.05102815179424756   0.05232287974647775;
  5000    128  NaN   0.04164499789361079   0.052333591220053904;
  5000    256  NaN   0.02618442197134807   0.06487806269774568;
  5000    512  NaN   0.017672231974254434   0.06327365592155092;  
  #  
  10000    16  NaN  0.09997978736445122   0.10006135662523578;
  10000    64  NaN  0.050298250430750265   0.05088164263264469;
  10000    128 NaN  0.04377474991972547   0.04694940425733192;
  10000    256 NaN  0.03012397095489149   0.060947419897955546;
  10000    512 NaN  0.023003220909326504   0.06427785429205589;
  #  
  20000    16  NaN  0.09582615248576822   0.09617832666157253;
  20000    64  NaN  0.05170648529604365   0.05213040457095706;
  20000    128 NaN  0.044387002190457596   0.04550915230284199;
  20000    256 NaN  0.03588759048996521   0.055779106939107204;  #todo
  20000    512 NaN  0.025725793707126184  0.06773422219860994; #todo
]

FNO_Data_Solid =
 [ 156    2         NaN        0.12054922604226757   0.14414993208999427;
  156    4         NaN         0.07358726692978793   0.09196700798726637;
  156    8         NaN         0.052437771172048425  0.07699770120775665;
  156    16        NaN         0.03416816555035162   0.07293769981143623;
  156    32        NaN         0.021201692385779125   0.08198683623096398;
  #  
  312    2          NaN        0.09380573048340005   0.11797815550410558;
  312    4          NaN        0.06780511970471245   0.07711609338557911;
  312    8         NaN         0.051782648274710394   0.06857374769010059;
  312    16         NaN        0.037710728324064004   0.06252741869388002;
  312    32         NaN        0.021732976140481374   0.07419626626244212;
  #  
  625    2           NaN       0.07907828340249898   0.09873100314521893;
  625    4           NaN       0.06243120087779477   0.068495422382559;   
  625    8         NaN         0.0512463722849898   0.0605111064388268;   
  625    16          NaN       0.04014251539210613   0.05735260729174315;
  625    32         NaN        0.022712888805342352   0.06894363440844378;  
  #  
  1250    2    NaN   0.0721604658552225   0.08559472825922429;
  1250     4   NaN   0.058587717519323075  0.06374132716451333;
  1250     8  NaN    0.05029862300579784   0.05644247173509566;
  1250    16  NaN    0.04331249470150343   0.05277286869792904;
  1250    32   NaN   0.0234019228670352    0.06401451171950027;  
  #  
  2500    2   NaN  0.06690852589616007   0.07703702018266063;
  2500     4  NaN  0.05543196399908585   0.05970591035402763;
  2500     8  NaN  0.049561563059286405  0.05269055695228226;
  2500    16  NaN  0.04600680480065976   0.049378732965302194;
  2500    32   NaN 0.026083269424247612  0.057459223701744284;  
  #  
  5000    2    NaN  0.06350585829725314   0.07335178690050474;
  5000    4   NaN   0.053625572579771665  0.05734815838413223;
  5000     8  NaN   0.04870559853052172   0.05149887586882659;
  5000    16  NaN   0.04598098710471801   0.04908295024692129;
  5000    32  NaN    0.031091677720447502   0.052560135418266235;  
  #  
  10000    2  NaN   0.06100410239285384   0.06987006746540537;
  10000    4  NaN   0.05150264963251262   0.055270600865062726;
  10000    8 NaN    0.04842893279212205   0.050226572697772816;
  10000    16 NaN   0.04668515263495779   0.048233262082042296;
  10000    32 NaN   0.043760100073658985   0.04803120092902064;
  #  
  20000    2   NaN    0.05900645581286424   0.06714351954759644;
  20000    4   NaN    0.05034109099491383   0.053047794020236856;
  20000    8   NaN    0.04785601547992645   0.04970943873454443;
  20000    16  NaN    0.04670982972818465   0.04777946294882538;
  20000    32  NaN    0.04619993448264109   0.047429043266354005
]

#######################
# adv
######################

PCA_Data_adv = 
[ 156    16         NaN    0.41148450443381096   1.625810339255293;
  156    64         NaN    0.16496452282641438   1.0629169437923072;
  156    128        NaN    0.09474028821582185   0.9356175810089464;
  156    256        NaN    0.031740080927560484   0.8089603786889419;
  156    512        NaN    0.0032491146734920985   0.739368829983151;
  #  
  312    16          NaN   0.35250528945185067   1.1101436777544917;
  312    64          NaN   0.16151865699318377   0.7631874803789671;
  312    128         NaN   0.09640880463645427   0.6478265381605203;
  312    256         NaN   0.039790927726516344   0.5858922346261116;
  312    512         NaN   0.008742270185856497   0.5330069291528844;
  #  
  625    16           NaN   0.31609561130602726   0.4520118750684096;
  625    64           NaN   0.16324623812752087   0.4057864120311623;  
  625    128          NaN   0.10051790706655708   0.3723980936905896;   
  625    256          NaN   0.04791087091548228   0.3433764106426739;
  625    512          NaN   0.011116839599901868   0.30930197886407357;  
  #  
  1250    16   NaN    0.2602626102718969   0.2658266222693516;
  1250    64   NaN    0.1556995448013612   0.19852913813760492;
  1250    128  NaN    0.11249045256776424   0.22878979751720818;
  1250    256  NaN    0.06274138235999062   0.23682843428824227;
  1250    512  NaN    0.02310467444972777   0.21220755350122175; 
  #  
  2500    16   NaN  0.2911999786587446   0.2955836267903681;
  2500    64   NaN  0.1447699662173425   0.15931452747039812;
  2500    128  NaN  0.11231850175061957   0.16142522843480409;
  2500    256  NaN  0.07510072071136398   0.18567479104726775;
  2500    512  NaN  0.02695173948095355   0.17563196034495848;  
  #  
  5000    16   NaN   0.2704528647550728   0.27169091853385946;
  5000    64   NaN   0.1506546960289392   0.15765421858879866;
  5000    128  NaN   0.11084497756644236   0.13906545950753305;
  5000    256  NaN   0.07371837976065146   0.16756864533451618;
  5000    512  NaN   0.021291121921620602   0.1527408494549857;  
  #  
  10000    16  NaN   0.2707286331343262   0.27075248693298576;
  10000    64  NaN   0.14286711040001046   0.14600134229109132;
  10000    128 NaN   0.11268536549659852   0.1313018292445184;
  10000    256 NaN   0.06250115808618784   0.16160805957839333;
  10000    512 NaN   0.030635775419660706   0.15176696266648593;
  #  
  20000    16  NaN   0.2609869382039488   0.26137727003888633;
  20000    64  NaN   0.14509676681568734   0.14685110188186196;
  20000    128 NaN   0.11496675471775764   0.12531453570808304;
  20000    256 NaN   0.06300039146761455   0.1615296879140314;
  20000    512 NaN   0.044766228513230574   0.153849630330182
]

DeepONet_Data_adv = 
 #################################  
 [ 156    16         NaN     0.5070580248489251   1.6189549263542216;
  156    64         NaN      0.32871913156023735   1.05655180168334;
  156    128         NaN     0.2606783749183887   0.9833009532472692;
  156    256        NaN      0.22213076778154234   0.7997425615738476;
  156    512        NaN      0.21050424108552226   0.812098064989847;
  #  
  312    16          NaN     0.4828297177863973   0.8937357900524027;
  312    64          NaN     0.2970174212435104   0.7599257161720466;
  312    128         NaN     0.23086576840032252   0.6293243710790005;
  312    256         NaN     0.18494241982334578   0.589066222274057;
  312    512         NaN     0.19701723237384777   0.5579974212453305;
  #  
  625    16           NaN    0.43298696261339126   0.5313266016900908;
  625    64           NaN    0.2631497661524192   0.4134477063990766;   
  625    128          NaN    0.20069787008685003   0.3675204990011779;   
  625    256          NaN    0.17377767621363227   0.341175346198033;
  625    512          NaN    0.16269238388969665   0.3079901534920736;  
  #  
  1250    16   NaN    0.42307395906430395   0.4280699948288257;
  1250    64   NaN    0.23294048914977353   0.2677328089642323;
  1250    128  NaN    0.17600211564692708   0.23835284569033693;
  1250    256  NaN    0.15419882031211463   0.22262201754015723;
  1250    512   NaN   0.14989769193582542   0.20782632134121376;  
  #  
  2500    16   NaN        0.34443226320742926   0.34953051365985766;
  2500    64   NaN        0.20569867654672117   0.2184996732720151;
  2500    128  NaN        0.1635424020233522   0.1923301554094833;
  2500    256  NaN        0.13727318342908684   0.1826352111262968;
  2500    512   NaN       0.142441122510508   0.17971471014935514;  
  #  
  5000    16    NaN  0.3390015311176906   0.339854837990065;
  5000    64   NaN   0.19125903806697445   0.19462081525486363;
  5000    128  NaN   0.15178129141255828   0.17090106431329896;
  5000    256  NaN   0.1256369182009571   0.1629317373210825;
  5000    512  NaN   0.12829018558872063   0.16149004169295325;  
  #  
  10000    16  NaN  0.31485445315516086   0.3147192442972554;
  10000    64  NaN  0.1754354707417321   0.17691830407099424;
  10000    128 NaN  0.13959321318814621   0.1595090071011537;
  10000    256 NaN  0.12371872580493146   0.15864968584320482;
  10000    512 NaN  0.1186759055943948   0.1524074389194938;
  #  
  20000    16   NaN  0.2818526103174339   0.2824034516936106;
  20000    64  NaN   0.17532498957747206   0.17641142396665413;
  20000    128 NaN   0.1412348384360671   0.1534566701805047;
  20000    256 NaN   0.12131616487757463   0.15380293653956004;
  20000    512 NaN   0.126880080082424   0.1540948772027392
]



PARA_Data_adv = 
 [ 156    16         NaN        0.26762557309627255   10.567036352369554;
  156    64         NaN         0.22871510111268242   5.051620374844744;
  156    128         NaN        0.22316206109768727   2.428105823731627;
  156    256        NaN         0.2037239725826691   1.247770079930493;
  156    512        NaN         0.19134236082736825   1.2310723634497105;
  #  
  312    16          NaN        0.34807542249653095   2.56904571069103;
  312    64          NaN        0.22759407907858623   1.8656539839038173;
  312    128         NaN        0.2228739292529412   1.2377686059868398;
  312    256         NaN        0.19699755814187636   0.9336052197877641;
  312    512         NaN        0.18817812997884098   0.8444843272033618;
  #  
  625    16           NaN       0.22156512484489194   0.849356584652454;
  625    64           NaN       0.19877872260630947   0.8350517037576246;   
  625    128         NaN        0.2033529973759153   0.7162350142261116;   
  625    256          NaN       0.17583636190051297   0.5982148373186592;
  625    512         NaN        0.17841499435441988   0.5895871621781661;  
  #  
  1250    16    NaN      0.21027730502993128   0.4907082794919668;
  1250    64   NaN       0.16518972108805097   0.52652695437646;
  1250    128  NaN       0.16261006510116932   0.4575275881074447;
  1250    256  NaN       0.1647856129194096   0.4064735011136244;
  1250    512   NaN      0.16059090954537034   0.40761957854180036;  
  #  
  2500    16   NaN    0.20639510082715798   0.32398266195456715;
  2500    64   NaN    0.14981098224826628   0.3815895700807757;
  2500    128  NaN    0.13859260792424988   0.3253177858931568;
  2500    256  NaN    0.1376911985317166   0.31370981848926477;
  2500    512   NaN   0.1400510848122096   0.30180196308948837;  
  #  
  5000    16    NaN  0.19055711923265867   0.22876288245332427;
  5000    64   NaN   0.140744880128135   0.26782993190745713;
  5000    128  NaN   0.13022641055224213   0.25138773938080056;
  5000    256  NaN   0.12813148382959771   0.249383753223002;
  5000    512  NaN   0.11914794570625588   0.233556070282211;  
  #  
  10000    16  NaN    0.17818617510566212   0.18938821704508652;
  10000    64  NaN   0.13537191187042774   0.20500198815404946;
  10000    128 NaN   0.1179429144528301   0.2133090602045811;
  10000    256 NaN   0.11286498847465651   0.20326229111377805;
  10000    512 NaN   0.11133452466670658   0.19839667703581082;
  #
  20000    16  NaN   0.1657959197563843   0.1713110576132001;
  20000    64  NaN   0.1341554075674926   0.16459538628063677;
  20000    128 NaN   0.11983618958668557   0.17752374839594073;
  20000    256 NaN   0.10621718390607414   0.17848990209261975;
  20000    512 NaN   0.1049167472534716   0.17596032934323255;
]

FNO_Data_adv =
 [ 156    2         NaN        0.14732429475929493   0.19252687769058424;
  156    4         NaN         0.13883701406228235   0.1498185106768058;
  156    8         NaN         0.1273765354297864   0.15127988861730465;
  156    16        NaN         0.11244011112751487   0.15542934073183018;
  156    32        NaN         0.08686964705180472   0.16607044970330137;
  #  
  312    2          NaN        0.20176373412593818   0.21489008382344857;
  312    4          NaN        0.13686082367665875   0.14270179852461204;
  312    8         NaN         0.1292798470419187    0.14088330644732103;
  312    16         NaN        0.10984872052302727   0.14229555307433772;
  312    32         NaN        0.09150851065388475   0.1511740550900308;
  
  #  
  625    2    NaN      0.13924972246289252   0.14888850654363633;
  625     4   NaN      0.13491478478312494   0.14197283232808114;
  625     8  NaN       0.12824824439585208   0.14085125638842583;
  625    16  NaN       0.1131444073677063   0.1430427407205105;
  625    32   NaN      0.09237072032764554   0.15906819927990437;  
  #  
  1250    2    NaN      0.16392094716429711   0.13649665738046168;
  1250     4   NaN      0.13518089597225189   0.13622529056370258;
  1250     8  NaN       0.1289861882865429   0.1359026584982872;
  1250    16  NaN       0.11087910863608122   0.14008150324374438;
  1250    32   NaN      0.09369939167052507   0.15675945473760367;  
  #  
  2500    2   NaN        0.13731948798447846   0.15506234875619412;
  2500     4   NaN       0.13437189842760563   0.13854013100117446;
  2500     8  NaN        0.1303224521882832   0.13844672850072384;
  2500    16  NaN        0.11557252415716648   0.14110596691071986;
  2500    32   NaN       0.09624609385039658   0.16309971330352127;  
  #  
  5000    2    NaN        0.14038108449429273   0.13817185688838363;
  5000    4   NaN          0.13588077685385944   0.13709425346776843;
  5000     8  NaN         0.13240791840329766   0.13563057239204646;
  5000    16  NaN         0.1215412126550451   0.13882315321564676;
  5000    32  NaN         0.10048962573166936   0.1515862295359373;  
  #  
  10000    2  NaN        0.15173418428078295   0.15856739647835494;
  10000    4  NaN        0.13454464524164797   0.1357434573814273;
  10000    8 NaN         0.13284966098852455   0.134365635548532;
  10000    16 NaN        0.1232320523605682   0.13654652388244867;
  10000    32 NaN        0.10523619120083749   0.14618092382922768;
  #  
  20000    2   NaN       0.13669491227064282   0.13629762759543956;
  20000    4   NaN       0.13373905710428954   0.13508056300282478;
  20000    8   NaN       0.13262592964693903   0.1338186941549182;
  20000    16  NaN       0.12837139420127497   0.13455450744889677;
  20000    32  NaN       0.11978913526094984   0.1349443169841543
]





PCA_Data = cat(PCA_Data_NS,PCA_Data_Helmholtz,PCA_Data_Solid,PCA_Data_adv,dims=3)
DeepONet_Data = cat(DeepONet_Data_NS,DeepONet_Data_Helmholtz,DeepONet_Data_Solid,DeepONet_Data_adv,dims=3)
FNO_Data = cat(FNO_Data_NS,FNO_Data_Helmholtz,FNO_Data_Solid,FNO_Data_adv,dims=3)
PARA_Data = cat(PARA_Data_NS,PARA_Data_Helmholtz,PARA_Data_Solid,PARA_Data_adv,dims=3)


# compute the cost


# complexity
Nps=[64^2 101^2 41^2  200]
n_ins = [128 101 21 200]

for i = 1:4 
  for j = 1:size(PCA_Data)[1]
      PCA_Data[j, 3, i] = PCA_Net_Cost(n_ins[i], PCA_Data[j, 2, i],4, Nps[i])
  end
  for j = 1:size(DeepONet_Data)[1]
      DeepONet_Data[j, 3, i] = DeepO_Net_Cost(n_ins[i], DeepONet_Data[j, 2, i],4, Nps[i])
  end
  for j = 1:size(PARA_Data)[1]
      PARA_Data[j, 3, i] = PARA_Net_Cost(n_ins[i], 1, PARA_Data[j, 2, i],4, Nps[i])
  end

  kmax = i < 4 ? 12^2 : 12
  for j = 1:size(FNO_Data)[1]
      FNO_Data[j, 3, i] = FNO_Net_Cost(FNO_Data[j, 2, i], kmax, 3, Nps[i])
  end
end
